## üêõ BUG REPORT #[N√öMERO]

### üìå T√çTULO:
[M√≥dulo] Comportamiento incorrecto + condici√≥n espec√≠fica

---

### üè∑Ô∏è CATEGOR√çA:
- [ ] Funcional (l√≥gica de negocio)
- [ ] UI/UX (interfaz, dise√±o)
- [ ] Performance (lentitud, timeout)
- [ ] Integraci√≥n (API, servicios externos)
- [ ] Seguridad (vulnerabilidad)
- [ ] Datos (validaci√≥n, integridad)
- [ ] Compatibilidad (browser, dispositivo)

---

### ‚ö†Ô∏è SEVERIDAD: [CR√çTICA/ALTA/MEDIA/BAJA]

**Justificaci√≥n t√©cnica:**
- ¬øBloquea funcionalidad core? [S√≠/No]
- ¬øHay workaround? [S√≠/No - describir]
- ¬øAfecta m√∫ltiples usuarios? [S√≠/No - %%]
- ¬øCausa p√©rdida de datos? [S√≠/No]

**Criterios aplicados:**
```
CR√çTICA: App crashea O core bloqueado O p√©rdida datos O seguridad
ALTA: Funcionalidad importante no funciona
MEDIA: Funcionalidad secundaria afectada
BAJA: Cosm√©tico sin impacto funcional
```

---

### üî• PRIORIDAD: [URGENTE/ALTA/MEDIA/BAJA]

**Justificaci√≥n de negocio:**
- **Impacto en usuarios:** [% o cantidad estimada]
- **Impacto financiero:** [P√©rdida ventas, SLA, legal]
- **Impacto reputacional:** [Reviews, prensa, redes]
- **Deadline cr√≠tico:** [Release, demo, evento]

---

### üåç AMBIENTE DE TESTING:

**Configuraci√≥n del sistema:**
- **Ambiente:** [Development / Staging / Production]
- **URL Base:** [https://staging.app.com]
- **API Version:** [v2.3.1]
- **Database:** [PostgreSQL 14.5 / Staging DB]

**Dispositivo/Browser:**
- **Browser:** Chrome 131.0.6778.86 (64-bit)
- **OS:** Windows 11 Pro (Build 22621)
- **Resoluci√≥n:** 1920x1080
- **Viewport:** Desktop (no responsive mode)
- **Network:** WiFi 4G/5G - 50 Mbps down / 10 Mbps up
- **DevTools abierto:** [S√≠/No]

**M√≥vil (si aplica):**
- **Dispositivo:** iPhone 13 Pro / Samsung Galaxy S21
- **OS:** iOS 17.2 / Android 13
- **App Version:** 2.5.1 (Build 347)
- **Conexi√≥n:** WiFi / 4G / 5G

---

### üîê CREDENCIALES/DATOS DE PRUEBA:

**Usuario de prueba:**
- Username: `test_user_001`
- Password: `TestPass123!`
- Role: [Standard User / Admin / Guest]

**Datos utilizados en el test:**
```
Campo 1: "valor exacto"
Campo 2: 12345
Campo 3: usuario@ejemplo.com
```

**IDs de entidades involucradas:**
- User ID: 45678
- Product ID: SKU-12345
- Order ID: ORD-2024-001

---

### üìã PRECONDICIONES:

**Estado inicial requerido:**
1. Usuario debe estar autenticado
2. Carrito debe contener al menos 1 producto
3. Datos de env√≠o deben estar guardados previamente
4. [Cualquier otra condici√≥n necesaria]

**Setup de datos (si aplica):**
```sql
-- Scripts ejecutados antes del test
INSERT INTO users (id, email) VALUES (123, 'test@test.com');
```

---

### üîÑ PASOS PARA REPRODUCIR:

**FLUJO COMPLETO:**

1. **[SETUP]** Abrir navegador Chrome en modo inc√≥gnito (Ctrl + Shift + N)

2. **[LOGIN]** 
   - Ir a https://staging.app.com/login
   - Ingresar username: `test_user_001`
   - Ingresar password: `TestPass123!`
   - Click en bot√≥n "Login"
   - **VERIFICAR:** Redirige a dashboard (/dashboard)

3. **[NAVEGACI√ìN]**
   - Desde dashboard ‚Üí Click men√∫ "Productos"
   - Esperar carga completa de lista (spinner desaparece)
   - Scroll hasta producto "Laptop Dell XPS 15"

4. **[ACCI√ìN PRINCIPAL]**
   - Click bot√≥n "Agregar al carrito"
   - **OBSERVAR:** Contador de carrito incrementa a 1
   - Click √≠cono carrito (esquina superior derecha)

5. **[CHECKOUT]**
   - En p√°gina carrito ‚Üí Click "Proceder al pago"
   - Completar formulario:
     - Nombre: `Juan P√©rez`
     - Direcci√≥n: `Av. Libertador 1234`
     - Ciudad: `Buenos Aires`
     - CP: `1425`
   - Click "Continuar"

6. **[PAGO]**
   - Seleccionar m√©todo: "Tarjeta de cr√©dito"
   - Ingresar datos tarjeta de prueba:
     - N√∫mero: `4111 1111 1111 1111`
     - Vencimiento: `12/25`
     - CVV: `123`
   - Click "Finalizar compra"

7. **[BUG OCURRE AQU√ç]**
   - **OBSERVAR:** Spinner aparece
   - **ESPERAR:** 30 segundos
   - **RESULTADO:** Spinner no desaparece, p√°gina congelada

**TIEMPO TOTAL DEL FLUJO:** ~3 minutos hasta el bug

**FRECUENCIA DE REPRODUCCI√ìN:**
- Intentos: 10/10 (100% reproducible)
- Ocurre: Siempre con tarjeta de prueba
- NO ocurre: Con m√©todo "Transferencia bancaria"

---

### ‚ùå RESULTADO ACTUAL (Comportamiento incorrecto):

**Qu√© sucede:**
1. Al hacer click en "Finalizar compra", aparece spinner de carga
2. Spinner permanece visible indefinidamente (testeado 5+ minutos)
3. P√°gina queda congelada, botones no responden
4. No hay redirecci√≥n a p√°gina de confirmaci√≥n
5. No se muestra mensaje de error

**Estado del sistema despu√©s del bug:**
- URL permanece en: `/checkout/payment`
- Carrito mantiene productos (no se vac√≠a)
- Base de datos: Orden NO fue creada (verificado en DB)
- Transacci√≥n de pago: NO se registr√≥

**Errores observables:**
- **En interfaz:** Ning√∫n mensaje de error visible
- **En consola del navegador:**
```javascript
  Uncaught TypeError: Cannot read property 'confirmationId' of undefined
    at processPayment (checkout.js:245)
```
- **En Network tab:**
```
  POST /api/v1/orders
  Status: 500 Internal Server Error
  Response time: 15234 ms
```

---

### ‚úÖ RESULTADO ESPERADO (Comportamiento correcto):

**Flujo esperado:**
1. Click en "Finalizar compra" ‚Üí Spinner visible m√°x 3 segundos
2. Request a API completado exitosamente (Status 200)
3. Redirecci√≥n autom√°tica a `/checkout/confirmation`
4. P√°gina de confirmaci√≥n muestra:
   - Mensaje: "¬°Compra exitosa!"
   - N√∫mero de orden: ORD-XXXX-YYYY
   - Resumen del pedido (productos, total, direcci√≥n)
   - Email de confirmaci√≥n enviado
5. Carrito se vac√≠a (contador en 0)
6. Orden creada en base de datos con estado "Paid"

**Performance esperada:**
- Tiempo de respuesta API: < 2 segundos
- Tiempo total del flujo: < 5 segundos
- Sin errores en consola

**Experiencia de usuario:**
- Feedback visual claro (spinner, luego confirmaci√≥n)
- Transici√≥n suave entre pasos
- Informaci√≥n completa de la orden

---

### üì∏ EVIDENCIA:

#### 1. Screenshot del bug
![Spinner infinito en checkout](https://imgur.com/abc123.png)
*Captura tomada despu√©s de 2 minutos de espera - p√°gina congelada*

#### 2. Video del flujo completo
üé• [Ver video (45 segundos)](https://loom.com/share/xyz789)
*Muestra desde agregar producto hasta el timeout*

#### 3. Error en consola del navegador
```javascript
// DevTools Console (F12)
checkout.js:245 Uncaught TypeError: Cannot read property 'confirmationId' of undefined
    at processPayment (checkout.js:245:18)
    at HTMLButtonElement.<anonymous> (checkout.js:189:12)
```

#### 4. Network activity (Chrome DevTools)
```
Request URL: https://staging.app.com/api/v1/orders
Request Method: POST
Status Code: 500 Internal Server Error
Response Time: 15234 ms

Request Headers:
  Content-Type: application/json
  Authorization: Bearer eyJhbGc...

Request Payload:
{
  "userId": 123,
  "items": [...],
  "paymentMethod": "credit_card"
}

Response Body:
{
  "error": "Database connection timeout",
  "code": "DB_TIMEOUT",
  "timestamp": "2026-01-24T15:23:45Z"
}
```

#### 5. Comparaci√≥n con ambiente funcional
| Aspecto | **Staging (Bug)** | **Production (OK)** |
|---------|-------------------|---------------------|
| Tiempo respuesta | 15+ segundos | 1.2 segundos |
| Status code | 500 | 200 |
| Orden creada | ‚ùå No | ‚úÖ S√≠ |
| Confirmaci√≥n | ‚ùå No | ‚úÖ S√≠ |

---

### üíº IMPACTO EN NEGOCIO:

**Usuarios afectados:**
- **Cantidad estimada:** 500-800 usuarios/d√≠a (15% del tr√°fico total)
- **Segmento:** Usuarios que usan tarjeta de cr√©dito en checkout
- **Geograf√≠a:** Todos los mercados

**Impacto financiero:**
- **P√©rdida directa:** $0 ventas en tarjeta (m√©todo m√°s usado - 60%)
- **Estimado mensual:** $150,000 USD en ventas perdidas
- **Abandono de carrito:** 100% de usuarios afectados

**Impacto en UX/Reputaci√≥n:**
- **Frustraci√≥n:** Extrema (usuario no puede completar compra)
- **Support tickets:** +45% en √∫ltimos 3 d√≠as
- **Reviews negativas:** 12 menciones en √∫ltimas 24hs
- **NPS:** Cay√≥ de 72 a 58 en √∫ltima semana

**Implicaciones legales/compliance:**
- **PCI-DSS:** Datos de tarjeta quedan en estado indefinido
- **GDPR:** Transacciones fallidas sin notificaci√≥n al usuario

---

### üîß INFORMACI√ìN ADICIONAL:

**Comparaci√≥n entre ambientes:**
```
‚úÖ Development: Checkout funciona OK (< 2 seg)
‚úÖ QA: Checkout funciona OK (< 2 seg)
‚ùå Staging: Bug reproducible (timeout 15+ seg)
‚ùì Production: No verificado a√∫n (en investigaci√≥n)
```

**Comparaci√≥n entre m√©todos de pago:**
```
‚ùå Tarjeta de cr√©dito: Bug 100% reproducible
‚úÖ Transferencia bancaria: Funciona OK
‚úÖ PayPal: Funciona OK
‚úÖ Mercado Pago: Funciona OK
```

**Datos t√©cnicos del servidor (si aplicable):**
```
CPU: 85% usage durante el request
RAM: 12.3 GB / 16 GB
Database connections: 245/250 (near limit)
Query execution time: 14.8 segundos (timeout configurado: 15 seg)
```

**Workaround disponible:**
- **Para usuarios:** Usar m√©todo "Transferencia bancaria" (conversi√≥n -70%)
- **Para equipo:** Reiniciar servicio de pagos cada 2 horas (temporal)

**Posible causa ra√≠z (hip√≥tesis):**
1. **M√°s probable:** Database query lenta por √≠ndice faltante en tabla `orders`
2. **Posible:** Timeout mal configurado en integraci√≥n con gateway de pago
3. **Menos probable:** Memory leak en servicio de checkout

**Sugerencias de fix:**
1. **Inmediato:** Aumentar timeout de DB de 15 a 30 segundos
2. **Corto plazo:** Optimizar query con √≠ndice en `orders.user_id`
3. **Largo plazo:** Implementar queue as√≠ncrona para procesamiento de √≥rdenes

**Tests de regresi√≥n sugeridos post-fix:**
- [ ] Verificar tiempo de respuesta < 3 seg
- [ ] Testear con 100 √≥rdenes concurrentes
- [ ] Validar creaci√≥n correcta en DB
- [ ] Confirmar email de confirmaci√≥n enviado
- [ ] Testear en todos los m√©todos de pago

---

### üîó REFERENCIAS:

**Issues relacionados:**
- #456: "Checkout lento en staging" (reportado hace 2 semanas)
- #423: "Database timeout en reportes" (mismo error DB)

**Documentaci√≥n:**
- [API Docs - POST /orders](https://docs.app.com/api/orders)
- [Figma - Checkout flow](https://figma.com/file/xyz)
- [Jira Epic - Payment Integration](https://jira.com/PROJ-123)

**Logs del servidor (si accesible):**
```
2026-01-24 15:23:45 ERROR [PaymentService] Database timeout after 15000ms
2026-01-24 15:23:45 ERROR [OrderController] Failed to create order for user 123
2026-01-24 15:23:45 WARN [DatabasePool] Connection pool at 98% capacity
```

---

### üìä DATOS DE SESI√ìN (para debugging):

**Session ID:** `sess_abc123xyz789`  
**Request ID:** `req_payment_001`  
**User Agent:** `Mozilla/5.0 (Windows NT 10.0; Win64; x64)...`  
**IP Address:** `192.168.1.100` (VPN: No)  
**Timestamp:** 2026-01-24 15:23:45 UTC

---

### ‚úÖ ESTADO DEL BUG:

- [ ] üÜï Nuevo (inicial)
- [ ] üîç En investigaci√≥n
- [ ] ‚úÖ Confirmado
- [ ] üîÑ En progreso
- [ ] üß™ En testing (post-fix)
- [ ] ‚úîÔ∏è Resuelto
- [ ] ‚ùå No se arreglar√° (wont-fix)
- [ ] üîÅ Reabierto

**Asignado a:** [Nombre del developer]  
**Sprint:** [Sprint 24.3]  
**Estimaci√≥n:** [3 story points]

---

**Reportado por:** Thiago Boveri (QA Analyst)  
**Email:** thiagonicolasboveriolace@gmail.com  
**Fecha reporte:** 2026-01-24  
**√öltima actualizaci√≥n:** 2026-01-24  
**Build/Versi√≥n:** v2.5.1-staging (Build #347)  
**Ticket ID:** BUG-001
